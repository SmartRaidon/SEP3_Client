@page "/signup"
@using ApiContracts
@rendermode InteractiveServer
@inject HttpClient Http

<input @bind="_newUsername" placeholder="Username"/>
<input @bind="_newPassword" placeholder="Password"/>
<button @onclick="AddUser">Sign up</button>
<div>Server response: <p>@_responseString</p></div>

@code
{
    string _newUsername = "";
    string _newPassword = "";
    string _responseString = "";

    async Task AddUser()
    {
        if (!string.IsNullOrWhiteSpace(_newUsername) && !string.IsNullOrWhiteSpace(_newPassword))
        {
            
            var user = new CreateUserDto()
            {
                Username = _newUsername,
                Password = _newPassword
            };
            
            
            // call REST endpoint here
            var response = await Http.PostAsJsonAsync("http://localhost:5284/api/Users", user); // change port according to business logic server
            if (response.IsSuccessStatusCode)
            {
                Console.WriteLine("User created successfully!");
                _responseString = "User created successfully!";
            }
            else
            {
                Console.WriteLine("Error while creating user!");
                _responseString = "Error while creating user!";
            }
            
            ClearFields();
        }
    }

    private void ClearFields()
    {
        // clear fields
        _newUsername = String.Empty;
        _newPassword = String.Empty;
    }
}